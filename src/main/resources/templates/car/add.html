<!DOCTYPE html>
<html xmls:th="http://www.thymeleaf.org">
<head th:replace="Layout/layout :: head"></head>
<body>
	<div class="container">

		<header th:replace="Layout/layout :: siteHeader"></header>

		<h1>Add new car</h1>
		<hr />

		<section class="content jumbotron">
    <form th:action="@{/car/save}" th:object="${car}" method="post" >
    
        <div class="form-group">
            <label for = "numberPlate">Number plate</label>
            <input type="text" th:field="*{numberplate}" class = "form-control" placeholder = "Write number plate"/>            
        </div>

        <div class="form-group">
        	<label for = "brand">Brand</label>         	         
			<select id="brand" class = "form-control" th:field="*{model.brand}">
				<option value="">-- Select a brand --</option>
				<option th:each="brand : ${brands}" th:text="${brand.descrip}" value="${brand.id}"></option>
			</select>
        </div>

        <div class="form-group">
			<label for = "model">Model</label>         	         
			<select id="model" class = "form-control" th:field="*{model}">
				<option value="">-- Select a brand --</option>
				<option th:each="model : ${models}" th:text="${model.descrip}" value="${model.id}"></option>
			</select>
        </div>

        <div class="form-group">
        	<label for = "price">Price</label>     
        	<input type="number" th:field="*{price}" class = "form-control numeric", placeholder = "Write the price, be careful with comma and dot for decimal, depend of system"/>                     
        </div>

        <input type="submit" class="btn btn-primary" value="Add" />
    </form>
</section>

 <script type="text/javascript">
    $(document).ready(function () {

        $("#cbBrand").change(function () {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("LoadModelsByIdBrand")',
                dataType: "json",
                data: { brand_id: $("#cbBrand").val() },
                success: function (models) {
                    $("#cbModel").empty();
                    $.each(models, function (i, model) {
                        $("#cbModel").append('<option value="' + model.value + '">' +
                            model.text + '</option>');
                    });
                },
                error: function (ex) {
                    alert('Failed to retrieve models.' + ex);
                }
            });
            return false;
        })
    });
</script>
	</div>
	<footer th:replace="Layout/layout :: siteFooter"></footer>

</body>
</html>